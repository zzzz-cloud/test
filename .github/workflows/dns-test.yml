name: DNS Lookup
on: [push, workflow_dispatch]  # æ”¯æŒæ¨é€å’Œæ‰‹åŠ¨è§¦å‘

jobs:
  kdig-test:
    runs-on: ubuntu-latest
    steps:
      - name: Install kdig
        run: |
          sudo apt-get update
          sudo apt-get install -y knot-dnsutils

      # =========================
      # ğŸ”¹ ä¼ ç»Ÿ UDP/TCP DNS æŸ¥è¯¢
      # =========================
      - name: Cloudflare DNS (1.1.1.1)
        run: kdig @1.1.1.1 h5.gantanhao.com

      - name: Google DNS (8.8.8.8)
        run: kdig @8.8.8.8 h5.gantanhao.com

      - name: Quad9 DNS (9.9.9.9)
        run: kdig @9.9.9.9 h5.gantanhao.com

      - name: OpenDNS (208.67.222.222)
        run: kdig @208.67.222.222 h5.gantanhao.com

      - name: AdGuard DNS (94.140.14.14)
        run: kdig @94.140.14.14 h5.gantanhao.com

      - name: Alibaba DNS (223.5.5.5)
        run: kdig @223.5.5.5 h5.gantanhao.com

      - name: DNSPod (119.29.29.29)
        run: kdig @119.29.29.29 h5.gantanhao.com


      # =========================
      # ğŸ”¹ DNS over TLS (DoT)
      # =========================
      - name: Cloudflare DoT
        run: kdig --tls @1.1.1.1 h5.gantanhao.com

      - name: Google DoT
        run: kdig --tls @8.8.8.8 h5.gantanhao.com +tls-host=dns.google

      - name: Quad9 DoT
        run: kdig --tls @9.9.9.9 h5.gantanhao.com +tls-host=dns.quad9.net

      - name: AdGuard DoT
        run: kdig --tls @94.140.14.14 h5.gantanhao.com +tls-host=unfiltered.adguard.com


      # =========================
      # ğŸ”¹ DNS over HTTPS (DoH) - å¯é€‰
      # =========================
      - name: Cloudflare DoH
        run: kdig --https --tls-ca https://1.1.1.1/dns-query h5.gantanhao.com

      - name: Google DoH
        run: kdig --https --tls-ca https://dns.google/dns-query h5.gantanhao.com

      - name: Quad9 DoH
        run: kdig --https --tls-ca https://dns.quad9.net/dns-query h5.gantanhao.com
